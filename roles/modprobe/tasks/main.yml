---
# tasks file for modprobe

- name: Ensure modprobe requirements are installed
  ansible.builtin.dnf:
    name: "{{ modprobe_requirements }}"
    state: present

- name: Load requested modules
  community.general.modprobe:
    name: "{{ item.name }}"
    state: present
  loop: "{{ modprobe_modules }}"
  when:
    - modprobe_modules is defined

- name: Remove modules
  community.general.modprobe:
    name: "{{ item.name }}"
    state: absent
  loop: "{{ modprobe_blacklisted_modules }}"
  when:
    - modprobe_blacklisted_modules is defined
  
